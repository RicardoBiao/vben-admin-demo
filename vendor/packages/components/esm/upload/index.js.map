{"version":3,"file":"index.js","sourceRoot":"lib/","sources":["upload/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,cAAc,CAAA;AAChD,OAAO,EACL,MAAM,IAAI,UAAU,EACpB,aAAa,IAAI,gBAAgB,GAClC,MAAM,gBAAgB,CAAA;AACvB,OAAO,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAK/C,OAAO,EAAE,eAAe,EAAE,CAAC,EAAE,MAAM,KAAK,CAAA;AAYxC,IAAM,aAAa,GAAG,eAAe,CAAe;IAClD,IAAI,EAAE,eAAe;IACrB,KAAK,EAAE,CAAC,QAAQ,CAAC;IACjB,KAAK,EAAL,UAAM,KAAK,EAAE,EAAsB;YAApB,KAAK,WAAA,EAAE,KAAK,WAAA,EAAE,IAAI,UAAA;QAC/B,OAAO;YACL,IAAM,QAAQ,gBACT,KAAK,CACT,CAAA;YACO,IAAA,QAAQ,GAAmB,KAAK,SAAxB,EAAK,SAAS,UAAK,KAAK,EAAlC,YAA0B,CAAF,CAAU;YACxC,OAAO,CAAC,CACN,UAAU,wBAEL,SAAS,KACZ,QAAQ,EAAE,UAAC,EAAY;wBAAV,QAAQ,cAAA;oBACnB,CAAC;oBAAC,QAA4B,aAA5B,QAAQ,uBAAR,QAAQ,CAAuB,QAAQ,CAAC,CAAA;oBAC1C,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAA;gBAC1B,CAAC,KAEH,QAAQ,CACT,CAAA;QACH,CAAC,CAAA;IACH,CAAC;CACF,CAAC,CAAA;AAEF,IAAM,oBAAoB,GAAG,eAAe,CAAe;IACzD,IAAI,EAAE,sBAAsB;IAC5B,KAAK,EAAE,CAAC,QAAQ,CAAC;IACjB,KAAK,EAAL,UAAM,KAAK,EAAE,EAAsB;YAApB,KAAK,WAAA,EAAE,KAAK,WAAA,EAAE,IAAI,UAAA;QAC/B,OAAO;YACL,IAAM,QAAQ,gBACT,KAAK,CACT,CAAA;YACO,IAAA,QAAQ,GAAmB,KAAK,SAAxB,EAAK,SAAS,UAAK,KAAK,EAAlC,YAA0B,CAAF,CAAU;YAExC,OAAO,CAAC,CACN,gBAAgB,wBAEX,SAAS,KACZ,QAAQ,EAAE,UAAC,EAAY;wBAAV,QAAQ,cAAA;oBACnB,CAAC;oBAAC,QAA4B,aAA5B,QAAQ,uBAAR,QAAQ,CAAuB,QAAQ,CAAC,CAAA;oBAC1C,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAA;gBAC1B,CAAC,KAEH,QAAQ,CACT,CAAA;QACH,CAAC,CAAA;IACH,CAAC;CACF,CAAC,CAAA;AAEF,IAAM,OAAO,GAAG,OAAO,CACrB,aAAa,EACb,QAAQ,CAAC;IACP,KAAK,EAAE,UAAU;IACjB,OAAO,EAAE,UAAU;CACpB,CAAC,CACH,CAAA;AAED,IAAM,aAAa,GAAG,OAAO,CAC3B,oBAAoB,EACpB,QAAQ,CAAC;IACP,KAAK,EAAE,UAAU;IACjB,OAAO,EAAE,UAAU;CACpB,CAAC,CACH,CAAA;AAED,MAAM,CAAC,IAAM,MAAM,GAAG,aAAa,CAAC,OAAO,EAAE;IAC3C,OAAO,EAAE,aAAa;CACvB,CAAC,CAAA;AAEF,eAAe,MAAM,CAAA","sourcesContent":["import { connect, mapProps } from '@formily/vue'\r\nimport {\r\n  Upload as AntdUpload,\r\n  UploadDragger as AntdUploadDrager,\r\n} from 'ant-design-vue'\r\nimport { composeExport } from '../__builtins__'\r\nimport type {\r\n  UploadFile,\r\n  UploadProps as AntdUploadProps,\r\n} from 'ant-design-vue/lib/upload'\r\nimport { defineComponent, h } from 'vue'\r\n\r\nexport type IUploadOnchange = (fileList: UploadFile[]) => void\r\n\r\nexport type IUploadProps = Omit<AntdUploadProps, 'onChange'> & {\r\n  onChange?: IUploadOnchange\r\n}\r\n\r\nexport type IDraggerUploadProps = Omit<AntdUploadProps, 'onChange'> & {\r\n  onChange?: IUploadOnchange\r\n}\r\n\r\nconst UploadWrapper = defineComponent<IUploadProps>({\r\n  name: 'UploadWrapper',\r\n  emits: ['change'],\r\n  setup(props, { slots, attrs, emit }) {\r\n    return () => {\r\n      const children = {\r\n        ...slots,\r\n      }\r\n      const { onChange, ...restAttrs } = attrs\r\n      return h(\r\n        AntdUpload,\r\n        {\r\n          ...restAttrs,\r\n          onChange: ({ fileList }) => {\r\n            ;(onChange as IUploadOnchange)?.(fileList)\r\n            emit('change', fileList)\r\n          },\r\n        },\r\n        children\r\n      )\r\n    }\r\n  },\r\n})\r\n\r\nconst UploaDraggerdWrapper = defineComponent<IUploadProps>({\r\n  name: 'UploaDraggerdWrapper',\r\n  emits: ['change'],\r\n  setup(props, { slots, attrs, emit }) {\r\n    return () => {\r\n      const children = {\r\n        ...slots,\r\n      }\r\n      const { onChange, ...restAttrs } = attrs\r\n\r\n      return h(\r\n        AntdUploadDrager,\r\n        {\r\n          ...restAttrs,\r\n          onChange: ({ fileList }) => {\r\n            ;(onChange as IUploadOnchange)?.(fileList)\r\n            emit('change', fileList)\r\n          },\r\n        },\r\n        children\r\n      )\r\n    }\r\n  },\r\n})\r\n\r\nconst _Upload = connect(\r\n  UploadWrapper,\r\n  mapProps({\r\n    value: 'fileList',\r\n    onInput: 'onChange',\r\n  })\r\n)\r\n\r\nconst UploadDragger = connect(\r\n  UploaDraggerdWrapper,\r\n  mapProps({\r\n    value: 'fileList',\r\n    onInput: 'onChange',\r\n  })\r\n)\r\n\r\nexport const Upload = composeExport(_Upload, {\r\n  Dragger: UploadDragger,\r\n})\r\n\r\nexport default Upload\r\n"]}